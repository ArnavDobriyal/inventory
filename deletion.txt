# deletion.py
import mysql.connector

# Establishing connection to the MySQL database
conn = mysql.connector.connect(
    host="localhost",
    port="3307",
    user="root",
    password="password",
    database="your_database"
)
cursor = conn.cursor()

def delete_customer(customer_id):
    """
    Delete a customer entry, their items, and the corresponding items in the inventory (replaced with null).
    """
    try:
        # Delete customer entry
        cursor.execute("DELETE FROM customers WHERE id = %s", (customer_id,))
        
        # Fetch item IDs associated with the customer
        cursor.execute("SELECT item_id FROM customers WHERE id = %s", (customer_id,))
        item_ids = cursor.fetchall()
        
        # Delete customer's items from the items table and replace inventory items with null
        for item_id in item_ids:
            # Delete item from items table
            cursor.execute("DELETE FROM items WHERE id = %s", item_id)
            
            # Replace corresponding inventory items with null
            cursor.execute("UPDATE inventory SET item_id = NULL WHERE item_id = %s", item_id)
        
        conn.commit()
        return True  # Deletion successful
    except mysql.connector.Error:
        conn.rollback()
        return False  # Deletion failed

def delete_inventory(item_id):
    """
    Delete an item from the inventory and replace it with null.
    """
    try:
        # Delete item from the inventory and replace it with null
        cursor.execute("UPDATE inventory SET item_id = NULL WHERE item_id = %s", (item_id,))
        conn.commit()
        return True  # Deletion successful
    except mysql.connector.Error:
        conn.rollback()
        return False  # Deletion failed

def delete_item(item_id):
    """
    Delete an item from the items table and replace corresponding inventory items with null.
    """
    try:
        # Delete item from the items table
        cursor.execute("DELETE FROM items WHERE id = %s", (item_id,))
        
        # Replace corresponding inventory item with null
        cursor.execute("UPDATE inventory SET item_id = NULL WHERE item_id = %s", (item_id,))
        
        conn.commit()
        return True  # Deletion successful
    except mysql.connector.Error:
        conn.rollback()
        return False  # Deletion failed
